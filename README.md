# ARP - AI Agent Reverse Proxy

> **éšæ—¶éšåœ°è®¿é—®æ‚¨çš„å†…ç½‘ AI æ™ºèƒ½ä½“**

## ğŸ¯ æ ¸å¿ƒä»·å€¼

**æ‚¨çš„ AI æ™ºèƒ½ä½“è¿è¡Œåœ¨å…¬å¸å†…ç½‘/å®¶åº­ç½‘ç»œï¼Œä½†æ‚¨éœ€è¦åœ¨ä»»ä½•åœ°æ–¹è®¿é—®å®ƒï¼Ÿ**

ARPï¼ˆAI Agent Reverse Proxyï¼‰è®©è¿™ä¸€åˆ‡å˜å¾—ç®€å•ï¼š

```
â˜ï¸ å’–å•¡å…ã€æœºåœºã€é…’åº—...      â†’    ğŸ¢ å…¬å¸å†…ç½‘çš„ Claude Code
ğŸ“± æ‰‹æœºã€å¹³æ¿ã€ç¬”è®°æœ¬...      â†’    ğŸ  å®¶ä¸­çš„ AI å¼€å‘ç¯å¢ƒ
ğŸŒ å…¨çƒä»»ä½•ç½‘ç»œä½ç½®...        â†’    ğŸ”’ NAT/é˜²ç«å¢™åçš„æ™ºèƒ½ä½“
```

**æ— éœ€é…ç½®è·¯ç”±å™¨ã€æ— éœ€ VPNã€æ— éœ€å…¬ç½‘ IP** â€” åªéœ€ä¸€ä¸ªä¸­è½¬æœåŠ¡å™¨ã€‚

---

## ğŸ’¡ å…¸å‹åœºæ™¯

### åœºæ™¯ 1: ç§»åŠ¨åŠå…¬

```
åœ¨å’–å•¡å…ç”¨ç¬”è®°æœ¬/æ‰‹æœº               å…¬å¸å†…ç½‘æœåŠ¡å™¨
     ğŸ’» ğŸ“±                             ğŸ–¥ï¸
     â”‚                                 â”‚
     â”‚ æ‰“å¼€ console.agentx.plus         â”‚  Claude Code
     â”‚ å¡«å…¥æœåŠ¡å™¨åœ°å€ + Token             â”‚  (å†…ç½‘ 192.168.1.100)
     â”‚                                 â”‚
     â””â”€â”€â”€â”€â”€â”€ Internet â”€â”€â”€â”€â”€â–º  â˜ï¸  â”€â”€â”€â”€â”€â–º
             å…¬ç½‘è®¿é—®         ARPæœåŠ¡å™¨
```

**æ•ˆæœ**ï¼šåœ¨æ˜Ÿå·´å…‹æ‰“å¼€æ‰‹æœºæµè§ˆå™¨ï¼Œè®¿é—® Web UIï¼Œå°±èƒ½è°ƒç”¨å…¬å¸å†…ç½‘çš„ Claude Codeï¼Œå°±åƒåœ¨åŠå…¬å®¤ä¸€æ ·ã€‚

### åœºæ™¯ 2: è¿œç¨‹åä½œ

```
å›¢é˜Ÿæˆå‘˜ A (åŒ—äº¬)  â”€â”
å›¢é˜Ÿæˆå‘˜ B (ä¸Šæµ·)  â”€â”¤
å®¢æˆ· (çº½çº¦)       â”€â”¤â”€â”€â–º  â˜ï¸ ARP  â”€â”€â–º  ğŸ¢ æ‚¨çš„ AI æ™ºèƒ½ä½“
                  â”‚    å…¬ç½‘å…¥å£      å†…ç½‘(æ— å…¬ç½‘IP)
åˆä½œä¼™ä¼´ (ä¼¦æ•¦)    â”€â”˜
```

**æ•ˆæœ**ï¼šæ‰€æœ‰äººé€šè¿‡ç»Ÿä¸€ URL è®¿é—®ï¼Œæ— éœ€æ¯ä¸ªäººé…ç½® VPNã€‚

### åœºæ™¯ 3: å¤šè®¾å¤‡æ— ç¼åˆ‡æ¢

```
æ—©ä¸Š: å°å¼æœº(å®¶ä¸­) â”€â”€â–º  â˜ï¸ ARP  â”€â”€â–º  ğŸ¢ å†…ç½‘ Claude Code
åˆä¼‘: æ‰‹æœº(å…¬å¸)   â”€â”€â–º     â”‚
æ™šä¸Š: å¹³æ¿(å’–å•¡å…) â”€â”€â–º     â”‚
              åŒä¸€ä¸ªä¼šè¯ï¼Œéšæ—¶ç»­æ¥
```

**æ•ˆæœ**ï¼šå·¥ä½œè¿ç»­æ€§ï¼Œä¼šè¯çŠ¶æ€è‡ªåŠ¨ä¿æŒã€‚

---

## ğŸš€ 5 åˆ†é’Ÿå¿«é€Ÿå¼€å§‹

### æ­¥éª¤ 1: å®‰è£…æœåŠ¡å™¨ç«¯ï¼ˆarpsï¼‰

åœ¨æœ‰å…¬ç½‘ IP çš„æœåŠ¡å™¨ä¸Šè¿è¡Œï¼ˆäº‘ä¸»æœºã€VPSã€å®¶ç”¨æœåŠ¡å™¨ + DDNS...ï¼‰

```bash
# ä¸€é”®å®‰è£…å¹¶å¯åŠ¨
curl -fsSL https://s3.agentx.plus/install.sh | bash
```

<details>
<summary>ğŸ“¦ æˆ–è€…ä»æºç ç¼–è¯‘ï¼ˆç‚¹å‡»å±•å¼€ï¼‰</summary>

```bash
git clone https://github.com/sxhxliang/arp.git
cd arp
cargo build --release

./target/release/arps \
  --control-port 17001 \
  --proxy-port 17002 \
  --public-port 17003
```
</details>

å®‰è£…å®Œæˆåï¼ŒæœåŠ¡å™¨å°†ç›‘å¬ï¼š
- **17001** - æ§åˆ¶ç«¯å£ï¼ˆå®¢æˆ·ç«¯æ³¨å†Œï¼‰
- **17002** - ä»£ç†ç«¯å£ï¼ˆéš§é“å»ºç«‹ï¼‰
- **17003** - å…¬ç½‘ç«¯å£ï¼ˆå¯¹å¤–è®¿é—®å…¥å£ï¼‰

### æ­¥éª¤ 2: å®‰è£…å®¢æˆ·ç«¯ï¼ˆarpcï¼‰

åœ¨å†…ç½‘æœºå™¨ä¸Šè¿è¡Œï¼ˆè¿™å°æœºå™¨è¿è¡Œæ‚¨çš„ AI æ™ºèƒ½ä½“ï¼‰

#### Linux / macOS

```bash
# ä¸€é”®å®‰è£…
curl -fsSL https://s3.agentx.plus/install-client.sh | bash

# å¯åŠ¨å®¢æˆ·ç«¯ï¼ˆå‘½ä»¤æ¨¡å¼ - ä»£ç† Claude Code ç­‰æ™ºèƒ½ä½“ï¼‰
arpc --server-addr <æ‚¨çš„å…¬ç½‘æœåŠ¡å™¨IP> --command-mode

# è¾“å‡ºç¤ºä¾‹ï¼š
# âœ… Starting agentc with client_id: 6D13F98FCCCD5F089AD96C3C7C13A81C
# ğŸ”— Successfully registered with the server.
# ğŸŒ Public URL: http://<æœåŠ¡å™¨IP>:17003?token=a1b2c3d4
```

#### Windows

```powershell
# åœ¨ PowerShell ä¸­è¿è¡Œ
irm https://s3.agentx.plus/install-client.ps1 | iex

# å¯åŠ¨å®¢æˆ·ç«¯
arpc --server-addr <æ‚¨çš„å…¬ç½‘æœåŠ¡å™¨IP> --command-mode
```

<details>
<summary>ğŸ“¦ æˆ–è€…ä»æºç è¿è¡Œï¼ˆç‚¹å‡»å±•å¼€ï¼‰</summary>

```bash
git clone https://github.com/sxhxliang/arp.git
cd arp

cargo run -p arpc -- \
  --server-addr <æ‚¨çš„å…¬ç½‘æœåŠ¡å™¨IP> \
  --command-mode
```
</details>

### æ­¥éª¤ 3: ä»ä»»ä½•åœ°æ–¹è®¿é—®

ç°åœ¨æ‚¨å¯ä»¥åœ¨**æ‰‹æœºã€å’–å•¡å…ã€æœºåœºã€é…’åº—...ä»»ä½•æœ‰ç½‘ç»œçš„åœ°æ–¹**è®¿é—®å†…ç½‘æ™ºèƒ½ä½“ï¼

#### ğŸ–¥ï¸ æ–¹å¼ 1ï¼šWeb UIï¼ˆæ¨èï¼‰

æ‰“å¼€æµè§ˆå™¨è®¿é—® Web ç®¡ç†ç•Œé¢ï¼Œæ— éœ€ä»»ä½•æŠ€æœ¯èƒŒæ™¯ï¼š
```
# æµè§ˆå™¨ç›´æ¥è®¿é—®ï¼ˆé»˜è®¤è¿çš„æ˜¯æˆ‘çš„æµ‹è¯•æœåŠ¡å™¨ï¼‰
https://console.agentx.plus/?token=ï¼ˆå®¢æˆ·ç«¯å¯åŠ¨æ—¶è¾“å‡ºçš„ client_idï¼‰
```
æˆ–è€…

```
# æµè§ˆå™¨è®¿é—®
https://console.agentx.plus
```

åœ¨ç•Œé¢ä¸­å¡«å…¥ï¼š
- **æœåŠ¡å™¨åœ°å€**ï¼š`<æ‚¨çš„å…¬ç½‘æœåŠ¡å™¨IP>:17003`ï¼ˆæˆ–æ‚¨çš„åŸŸåï¼‰
- **Token**ï¼š`a1b2c3d4`ï¼ˆå®¢æˆ·ç«¯å¯åŠ¨æ—¶è¾“å‡ºçš„ client_idï¼‰

ç‚¹å‡»è¿æ¥å³å¯ï¼š
- ğŸ“‚ æµè§ˆ Claude é¡¹ç›®å’Œä¼šè¯å†å²
- ğŸ’¬ åˆ›å»ºæ–°çš„æ™ºèƒ½ä½“æ‰§è¡Œä¼šè¯
- ğŸ“Š æŸ¥çœ‹ä¼šè¯çŠ¶æ€å’Œå®æ—¶è¾“å‡º
- ğŸ”„ ç®¡ç†æ­£åœ¨è¿è¡Œçš„ä»»åŠ¡

**é€‚åˆ**ï¼šéæŠ€æœ¯ç”¨æˆ·ã€ç§»åŠ¨è®¾å¤‡ã€å¿«é€Ÿæ¼”ç¤º

#### ğŸ”§ æ–¹å¼ 2ï¼šHTTP APIï¼ˆå¼€å‘è€…ï¼‰

é€šè¿‡ API é›†æˆåˆ°æ‚¨çš„åº”ç”¨ä¸­ï¼š

```bash
# åœ¨ä»»ä½•è®¾å¤‡ä¸Šï¼š
curl "http://<æœåŠ¡å™¨IP>:17003/api/claude/projects?token=a1b2c3d4"

# åˆ›å»ºæ–°ä¼šè¯
curl -X POST "http://<æœåŠ¡å™¨IP>:17003/api/sessions?token=a1b2c3d4" \
  -H "Content-Type: application/json" \
  -d '{"executor":"Claude","prompt":"åˆ†æè¿™ä¸ªé¡¹ç›®"}'
```

**é€‚åˆ**ï¼šå¼€å‘è€…é›†æˆã€è‡ªåŠ¨åŒ–è„šæœ¬ã€CI/CD æµç¨‹

âœ¨ **å°±è¿™ä¹ˆç®€å•ï¼**

---

## ğŸ” ä¸ºä»€ä¹ˆä¸ç›´æ¥æš´éœ²å†…ç½‘æœåŠ¡ï¼Ÿ

| æ–¹æ¡ˆ | å¤æ‚åº¦ | å®‰å…¨æ€§ | çµæ´»æ€§ |
|------|--------|--------|--------|
| **ç«¯å£è½¬å‘** | âŒ éœ€è¦è·¯ç”±å™¨é…ç½®<br>âŒ æ¯æ¬¡ç½‘ç»œå˜åŒ–éƒ½è¦é‡é… | âš ï¸ ç›´æ¥æš´éœ²å†…ç½‘ | âŒ å›ºå®šIP+ç«¯å£ |
| **VPN** | âŒ æ¯ä¸ªè®¿é—®è€…éƒ½è¦é…ç½®<br>âŒ ç§»åŠ¨è®¾å¤‡é…ç½®éº»çƒ¦ | âœ… åŠ å¯†é€šé“ | âš ï¸ éœ€è¦å®¢æˆ·ç«¯ |
| **ARP** | âœ… ä¸€æ¬¡éƒ¨ç½²ï¼Œåˆ°å¤„è®¿é—® | âœ… ä»…æš´éœ²ä»£ç†éš§é“<br>âœ… Token éš”ç¦» | âœ… ç»Ÿä¸€HTTPå…¥å£<br>âœ… æ”¯æŒæ‰€æœ‰è®¾å¤‡ |

---

## ğŸ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸŒ çœŸæ­£çš„"éšæ—¶éšåœ°"è®¿é—®

- âœ… **è·¨ç½‘ç»œ**ï¼šå’–å•¡å… WiFiã€4G/5Gã€é…’åº—ç½‘ç»œ...ä»»ä½•èƒ½ä¸Šç½‘çš„åœ°æ–¹
- âœ… **è·¨è®¾å¤‡**ï¼šæ‰‹æœºã€å¹³æ¿ã€ç¬”è®°æœ¬ã€å°å¼æœºï¼Œæµè§ˆå™¨å³å¯è®¿é—®
- âœ… **è·¨å¹³å°**ï¼šWindowsã€macOSã€Linuxã€iOSã€Android é€šåƒ
- âœ… **é›¶å­¦ä¹ æˆæœ¬**ï¼šæä¾› Web UI [https://console.agentx.plus](https://console.agentx.plus)ï¼Œå¡«å…¥æœåŠ¡å™¨åœ°å€å’Œ Token å³å¯ä½¿ç”¨

### âš¡ ä½å»¶è¿Ÿè®¾è®¡

- **è¿æ¥æ± é¢„çƒ­**ï¼šä»£ç†éš§é“é¢„å…ˆå»ºç«‹ï¼Œå¹³å‡å“åº” < 50ms
- **é›¶æ‹·è´è½¬å‘**ï¼šRust å¼‚æ­¥ I/Oï¼Œå‡å°‘å†…å­˜æ‹·è´
- **TCP ä¼˜åŒ–**ï¼š`TCP_NODELAY` + å¤§ç¼“å†²åŒº
- **è‡ªåŠ¨é‡è¿**ï¼šå®¢æˆ·ç«¯æ–­çº¿åè‡ªåŠ¨é‡è¿ï¼ˆå¯é…ç½®é—´éš”å’Œå¼€å…³ï¼‰

### ğŸ›¡ï¸ å®‰å…¨éš”ç¦»

- å†…ç½‘æœåŠ¡ä¸ç›´æ¥æš´éœ²å…¬ç½‘
- æ¯ä¸ªå®¢æˆ·ç«¯ç‹¬ç«‹ `client_id` Token
- æ”¯æŒ HTTPS/WSSï¼ˆé€šè¿‡ nginx å‰ç½®ï¼‰

### ğŸ”Œ å¤šæ™ºèƒ½ä½“æ”¯æŒ

åŒæ—¶ä»£ç†å¤šä¸ª AI æ™ºèƒ½ä½“ï¼š

```bash
# æœºå™¨ Aï¼šClaude Code
arpc --client-id claude-agent --command-mode

# æœºå™¨ Bï¼šæœ¬åœ° LLM API
arpc --client-id llm-api --local-port 8000

# è®¿é—®ï¼š
# http://server:17003/api/sessions?token=claude-agent
# http://server:17003/anything?token=llm-api
```

---

## ğŸ“¡ å·¥ä½œåŸç†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: å®¢æˆ·ç«¯æ³¨å†Œï¼ˆå¯åŠ¨æ—¶è‡ªåŠ¨å®Œæˆï¼‰                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

å†…ç½‘å®¢æˆ·ç«¯                      å…¬ç½‘æœåŠ¡å™¨
  arpc                          arps
    â”‚                               â”‚
    â”‚  â‘  Register {client_id}       â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
    â”‚                               â”‚
    â”‚  â‘¡ RegisterResult {success}   â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                               â”‚
    â”‚  â‘¢ å»ºç«‹ä»£ç†è¿æ¥æ± (é¢„çƒ­)          â”‚
    â”œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
    â”œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2: å¤–éƒ¨è®¿é—®ï¼ˆä»ä»»ä½•åœ°æ–¹ï¼‰                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    æ‰‹æœº/ç¬”è®°æœ¬                  å…¬ç½‘æœåŠ¡å™¨              å†…ç½‘å®¢æˆ·ç«¯
  (å’–å•¡å…/æœºåœº)                   arps                 arpc
       â”‚                            â”‚                      â”‚
       â”‚  GET /api/sessions         â”‚                      â”‚
       â”‚  ?token=client_id          â”‚                      â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                      â”‚
       â”‚                            â”‚                      â”‚
       â”‚                            â”‚  â‘£ ä»è¿æ¥æ± å–å‡ºéš§é“    â”‚
       â”‚                            â”œâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–ºâ”‚
       â”‚                            â”‚                      â”‚
       â”‚                            â”‚  â‘¤ è¯·æ±‚è½¬å‘åˆ°AIæ™ºèƒ½ä½“  â”‚
       â”‚                            â”‚                      â”œâ”€â”€â–º Claude Code
       â”‚                            â”‚                      â”‚
       â”‚                            â”‚  â‘¥ å“åº”è¿”å›           â”‚
       â”‚                            â”‚â—„â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â”¤
       â”‚  â‘¦ HTTP Response           â”‚                      â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
```

**å…³é”®ç‚¹**ï¼š
- å†…ç½‘å®¢æˆ·ç«¯**ä¸»åŠ¨è¿æ¥**å…¬ç½‘æœåŠ¡å™¨ï¼ˆä¸éœ€è¦å…¬ç½‘ IPï¼‰
- è¿æ¥æ± æœºåˆ¶ï¼šé¢„å…ˆå»ºç«‹å¤šæ¡éš§é“ï¼Œå¤–éƒ¨è¯·æ±‚åˆ°è¾¾æ—¶ç«‹å³å¤ç”¨
- Token è·¯ç”±ï¼šé€šè¿‡ `?token=<client_id>` å°†è¯·æ±‚è·¯ç”±åˆ°å¯¹åº”å†…ç½‘å®¢æˆ·ç«¯

---

## ğŸ“š æ”¯æŒçš„ AI æ™ºèƒ½ä½“

### å¼€ç®±å³ç”¨

- âœ… **Claude Code** - Anthropic å®˜æ–¹ CLI
- âœ… **Codex** - OpenAI Codex CLI
- âœ… **Gemini** - Google Gemini CLIï¼ˆå¾…å®Œå–„ï¼‰

### API èƒ½åŠ›

å½“å®¢æˆ·ç«¯è¿è¡Œåœ¨ `--command-mode`ï¼Œæä¾› HTTP APIï¼š

#### ä¼šè¯ç®¡ç†

```bash
# åˆ›å»ºæ‰§è¡Œä¼šè¯
POST /api/sessions?token=<client_id>
{
  "executor": "Claude",
  "model": "claude-sonnet-4.5",
  "prompt": "å¸®æˆ‘é‡æ„è¿™ä¸ªå‡½æ•°",
  "projectPath": "/home/user/myproject"
}

# æŸ¥è¯¢ä¼šè¯çŠ¶æ€
GET /api/sessions/{session_id}?token=<client_id>

# å–æ¶ˆ/åˆ é™¤ä¼šè¯
DELETE /api/sessions/{session_id}?token=<client_id>
```

#### æ–‡ä»¶ç³»ç»Ÿæµè§ˆ

> âš ï¸ é»˜è®¤å…³é—­ï¼šå¯åŠ¨ `arpc` å®¢æˆ·ç«¯æ—¶éœ€å¸¦ä¸Š `--enable-fs` æˆ–åœ¨é…ç½®ä¸­å°†ä»£ç ä¸­çš„`enable_fs` è®¾ä¸º `true` æ‰ä¼šå¼€æ”¾ä»¥ä¸‹æ¥å£ã€‚

```bash
# æµè§ˆä¼šè¯é¡¹ç›®æ ¹ç›®å½•
GET /api/sessions/{session_id}/fs?token=<client_id>

# æµè§ˆä¼šè¯é¡¹ç›®å­è·¯å¾„æˆ–è¯»å–æ–‡ä»¶
GET /api/sessions/{session_id}/fs/{path}?token=<client_id>

# ç›´æ¥æŒ‰è·¯å¾„æŸ¥çœ‹ä»»ä½•é¡¹ç›®ç›®å½•ï¼ˆæ— éœ€ sessionï¼‰
GET /api/fs?token=<client_id>&project_path=/abs/path/to/project

# æŸ¥çœ‹é¡¹ç›®å†…å­ç›®å½•æˆ–æ–‡ä»¶
GET /api/fs/{path}?token=<client_id>&project_path=/abs/path/to/project
```

> `project_path` å¿…é¡»æ˜¯æœåŠ¡å™¨ä¸Šçš„ç»å¯¹è·¯å¾„ï¼Œ`path` å¯ä»¥ç”¨ `path` æŸ¥è¯¢å‚æ•°æˆ–å°¾éƒ¨é€šé…è·¯å¾„æä¾›ï¼›å“åº”ä¼šè¿”å›ç›®å½•æ¡ç›®æˆ–æ–‡ä»¶å†…å®¹ï¼ˆæœ€å¤§ 1 MiBï¼Œè¶…å‡ºæ—¶æ ‡è®° `truncated=true`ï¼‰ã€‚

#### AI æ™ºèƒ½ä½“ä¸“å±åŠŸèƒ½

æ‰€æœ‰æ™ºèƒ½ä½“ï¼ˆClaudeã€Codexã€Geminiï¼‰å…±äº«ç»Ÿä¸€çš„ API æ¨¡å¼ï¼Œåªéœ€å°†è·¯å¾„ä¸­çš„ `{agent}` æ›¿æ¢ä¸º `claude`ã€`codex` æˆ– `gemini`ï¼š

```bash
# åˆ—å‡ºæœ¬åœ°é¡¹ç›®
GET /api/{agent}/projects?token=<client_id>

# æŸ¥çœ‹æœ€è¿‘ä½¿ç”¨çš„å·¥ä½œç›®å½•æ‘˜è¦
GET /api/{agent}/projects/working-directories?token=<client_id>

# æŸ¥è¯¢å†å²ä¼šè¯ï¼ˆæ”¯æŒåˆ†é¡µå’Œé¡¹ç›®è·¯å¾„è¿‡æ»¤ï¼‰
GET /api/{agent}/sessions?token=<client_id>&limit=50&offset=0&projectPath=/abs/path

# åŠ è½½ä¼šè¯æ¶ˆæ¯
GET /api/{agent}/sessions/{session_id}?token=<client_id>

# åˆ é™¤ä¼šè¯
DELETE /api/{agent}/sessions/{session_id}?token=<client_id>
```

**æŸ¥è¯¢å‚æ•°è¯´æ˜ï¼š**
- `limit` - è¿”å›ç»“æœæ•°é‡é™åˆ¶ï¼ˆå¯é€‰ï¼‰
- `offset` - åˆ†é¡µåç§»é‡ï¼ˆå¯é€‰ï¼‰
- `projectPath` - æŒ‰ç»å¯¹è·¯å¾„è¿‡æ»¤ä¼šè¯ï¼ˆå¯é€‰ï¼‰

**ç¤ºä¾‹ï¼š**
```bash
# Claude é¡¹ç›®
GET /api/claude/projects?token=abc123

# Codex å†å²ä¼šè¯ï¼ˆè¿‡æ»¤ç‰¹å®šé¡¹ç›®ï¼‰
GET /api/codex/sessions?token=abc123&projectPath=/home/user/myproject

# Gemini ä¼šè¯æ¶ˆæ¯
GET /api/gemini/sessions/session_123?token=abc123
```

### çº¯è½¬å‘æ¨¡å¼

ä¹Ÿå¯ä»¥ä»£ç†ä»»ä½• TCP æœåŠ¡ï¼ˆWeb åº”ç”¨ã€API...ï¼‰ï¼š

```bash
cargo run -p arpc -- \
  --server-addr <å…¬ç½‘IP> \
  --local-addr 127.0.0.1 \
  --local-port 3000  # æœ¬åœ°æœåŠ¡ç«¯å£
```

è®¿é—®ï¼š`http://<å…¬ç½‘IP>:17003?token=<client_id>` â†’ è‡ªåŠ¨è½¬å‘åˆ°å†…ç½‘ `localhost:3000`

---

## ğŸ—ï¸ ç”Ÿäº§éƒ¨ç½²

### æœåŠ¡å™¨ç«¯ï¼ˆarpsï¼‰

ä½¿ç”¨ systemd ç®¡ç†ï¼š

```bash
# 1. æ„å»º
cargo build --release

# 2. å®‰è£…æœåŠ¡
sudo scripts/install_server.sh

# 3. é…ç½®ç«¯å£ï¼ˆå¯é€‰ï¼‰
sudo systemctl edit arps
# æ·»åŠ ç¯å¢ƒå˜é‡ï¼š
[Service]
Environment="PUBLIC_PORT=80"  # ä½¿ç”¨æ ‡å‡† HTTP ç«¯å£

# 4. å¯åŠ¨
sudo systemctl start arps
sudo systemctl enable arps  # å¼€æœºè‡ªå¯

# 5. æŸ¥çœ‹æ—¥å¿—
journalctl -u arps -f
```

### å®¢æˆ·ç«¯ï¼ˆarpcï¼‰

#### Linux/macOS

```bash
# æ·»åŠ åˆ° crontab
crontab -e

# æ·»åŠ è¡Œï¼š
@reboot cd /path/to/arp && cargo run -p arpc -- \
  --server-addr <IP> --command-mode >> /tmp/arpc.log 2>&1
```

#### Windows

åˆ›å»º `startup.bat` å¹¶åŠ åˆ°å¯åŠ¨é¡¹ï¼š

```batch
cd C:\path\to\arp
cargo run -p arpc -- --server-addr <IP> --command-mode
```

### é…ç½® HTTPSï¼ˆæ¨èï¼‰

åœ¨ arps å‰éƒ¨ç½² nginxï¼š

```nginx
server {
    listen 443 ssl;
    server_name your-domain.com;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    location / {
        proxy_pass http://127.0.0.1:17003;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

ç°åœ¨å¯ä»¥é€šè¿‡ HTTPS è®¿é—®ï¼š
```
https://your-domain.com/api/sessions?token=<client_id>
```

---

## ğŸ® å®æˆ˜ç¤ºä¾‹

### ç¤ºä¾‹ 1: ç§»åŠ¨ç«¯è®¿é—®å†…ç½‘ Claude Code

**åœºæ™¯**ï¼šåœ¨å’–å•¡å…ç”¨æ‰‹æœºè®¿é—®å…¬å¸å†…ç½‘çš„ Claude Code

#### ä½¿ç”¨ Web UIï¼ˆæœ€ç®€å•ï¼‰

```bash
# 1. å…¬å¸å†…ç½‘æœºå™¨å¯åŠ¨å®¢æˆ·ç«¯
arpc --server-addr proxy.example.com --command-mode
# è¾“å‡º token: abc123

# 2. æ‰‹æœºæµè§ˆå™¨æ‰“å¼€
https://console.agentx.plus

# 3. å¡«å†™è¿æ¥ä¿¡æ¯
æœåŠ¡å™¨åœ°å€: proxy.example.com:17003
Token: abc123

# 4. ç‚¹å‡»"è¿æ¥"åï¼Œå³å¯ï¼š
# - æŸ¥çœ‹ Claude é¡¹ç›®åˆ—è¡¨
# - åˆ›å»ºæ–°ä¼šè¯ï¼š"å¸®æˆ‘åˆ†æå…¬å¸é¡¹ç›®æ¶æ„"
# - å®æ—¶æŸ¥çœ‹æ‰§è¡Œè¾“å‡º
```

#### ä½¿ç”¨ APIï¼ˆå¼€å‘è€…é›†æˆï¼‰

```bash
# 1. åˆ—å‡ºé¡¹ç›®
curl "https://proxy.example.com:17003/api/claude/projects?token=abc123"

# 2. åˆ›å»ºä¼šè¯
curl -X POST "https://proxy.example.com:17003/api/sessions?token=abc123" \
  -H "Content-Type: application/json" \
  -d '{
    "executor": "Claude",
    "prompt": "åˆ†æå½“å‰ç›®å½•çš„ä»£ç ç»“æ„"
  }'

# 3. æŸ¥çœ‹è¾“å‡º
curl "https://proxy.example.com:17003/api/sessions/{session_id}?token=abc123"
```

### ç¤ºä¾‹ 2: å¤šå›¢é˜Ÿå…±äº«å†…ç½‘æ™ºèƒ½ä½“

```bash
# å…¬å¸æœåŠ¡å™¨ Aï¼šä»£ç†å›¢é˜Ÿçš„ Claude Code
arpc --client-id team-a --command-mode

# å…¬å¸æœåŠ¡å™¨ Bï¼šä»£ç†å›¢é˜Ÿçš„è‡ªå®šä¹‰ LLM
arpc --client-id team-b --local-port 8000

# å›¢é˜Ÿ A æˆå‘˜è®¿é—®ï¼š
https://proxy.company.com/api/sessions?token=team-a

# å›¢é˜Ÿ B æˆå‘˜è®¿é—®ï¼š
https://proxy.company.com/chat?token=team-b
```

### ç¤ºä¾‹ 3: å®¶åº­ç½‘ç»œçš„ AI åŠ©æ‰‹

```bash
# å®¶ä¸­ NAS/æ ‘è“æ´¾ è¿è¡Œå®¢æˆ·ç«¯
arpc --server-addr home-proxy.ddns.net --command-mode

# å¤–å‡ºæ—¶ç”¨æ‰‹æœºè®¿é—®ï¼š
# - åœ¨åœ°é“ä¸ŠæŸ¥çœ‹ Claude é¡¹ç›®è¿›åº¦
# - åœ¨å’–å•¡å…åˆ›å»ºæ–°çš„ä»£ç åˆ†æä»»åŠ¡
# - åœ¨é…’åº—ç»­æ¥æ—©ä¸Šæœªå®Œæˆçš„ä¼šè¯
```

---

## ğŸ”§ é«˜çº§é…ç½®

### è‡ªå®šä¹‰ client_id

```bash
# å›ºå®š IDï¼ˆæ–¹ä¾¿è®°å¿†å’Œé…ç½®ï¼‰
arpc --client-id my-workspace --server-addr <IP> --command-mode

# è®¿é—® URL
http://<IP>:17003/api/sessions?token=my-workspace
```

### è‡ªåŠ¨é‡è¿é…ç½®

```bash
# å¯ç”¨è‡ªåŠ¨é‡è¿ï¼ˆé»˜è®¤å¼€å¯ï¼Œé—´éš” 5 ç§’ï¼‰
arpc --client-id my-agent --command-mode

# ç¦ç”¨è‡ªåŠ¨é‡è¿
arpc --client-id my-agent --command-mode --auto-reconnect=false

# è‡ªå®šä¹‰é‡è¿é—´éš”ï¼ˆ10 ç§’ï¼‰
arpc --client-id my-agent --command-mode --reconnect-interval 10
```

### è°ƒæ•´è¿æ¥æ± å¤§å°

```bash
# æœåŠ¡å™¨ç«¯ï¼šæ¯ä¸ªå®¢æˆ·ç«¯é¢„çƒ­ 5 ä¸ªè¿æ¥
arps --pool-size 5

# é«˜å¹¶å‘åœºæ™¯å»ºè®® 5-10
# ä½é¢‘è®¿é—®åœºæ™¯å»ºè®® 1-2
```

### æŒ‡å®š Claude å‘½ä»¤è·¯å¾„

```bash
arpc --command-path "/opt/claude/bin/claude" --command-mode
```

### å¯ç”¨è°ƒè¯•æ—¥å¿—

```bash
RUST_LOG=debug cargo run -p arpc -- <å‚æ•°>
```

---

## ğŸ“Š æ€§èƒ½æ•°æ®

æµ‹è¯•ç¯å¢ƒï¼šå…¬ç½‘æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘ ECSï¼‰+ å†…ç½‘å®¢æˆ·ç«¯ï¼ˆå®¶åº­å®½å¸¦ï¼‰

| æŒ‡æ ‡ | è¿æ¥æ± å‘½ä¸­ | è¿æ¥æ± æœªå‘½ä¸­ |
|------|-----------|-------------|
| **å“åº”å»¶è¿Ÿ** | 45ms | 180ms |
| **ååé‡** | ~500 req/s | ~150 req/s |
| **å†…å­˜å ç”¨** | arps: 20MB<br>arpc: 15MB | - |

**ç»“è®º**ï¼šè¿æ¥æ± æœºåˆ¶å¤§å¹…é™ä½å»¶è¿Ÿï¼Œé€‚åˆäº¤äº’å¼åœºæ™¯ã€‚

---

## â“ å¸¸è§é—®é¢˜

### Q: æœåŠ¡å™¨ç«¯ä¼šä¿ç•™è®¿é—®è®°å½•å—ï¼Ÿ

A: âŒ ä¸ä¼šã€‚æœåŠ¡å™¨ç«¯åªä¼šå“åº”è¯·æ±‚å’Œè½¬å‘æ•°æ®ï¼Œä¸ä¿å­˜ä»»ä½•è®¿é—®è®°å½•ã€‚
[è¯¦ç»†](/arp-server/src/main.rs)

### Q: æ‰‹æœº 4G ç½‘ç»œå¯ä»¥è®¿é—®å—ï¼Ÿ

A: âœ… å¯ä»¥ï¼åªè¦èƒ½è®¿é—®å…¬ç½‘æœåŠ¡å™¨å³å¯ï¼Œä»»ä½•ç½‘ç»œéƒ½æ”¯æŒï¼ˆWiFiã€4Gã€5G...ï¼‰ã€‚

### Q: å¤šäººåŒæ—¶è®¿é—®ä¼šå†²çªå—ï¼Ÿ

A: âŒ ä¸ä¼šã€‚æ¯ä¸ªè¯·æ±‚ç‹¬ç«‹å¤„ç†ï¼Œæ”¯æŒå¹¶å‘ï¼ˆå—é™äº `--pool-size` é…ç½®ï¼‰ã€‚

### Q: å†…ç½‘å®¢æˆ·ç«¯æ–­çº¿æ€ä¹ˆåŠï¼Ÿ

A: å®¢æˆ·ç«¯ä¼šè‡ªåŠ¨é‡è¿ã€‚

### Q: å¦‚ä½•ä¿è¯å®‰å…¨æ€§ï¼Ÿ

A:
1. ä½¿ç”¨ HTTPSï¼ˆnginx + Let's Encryptï¼‰
2. åœ¨ arps å‰é…ç½®é˜²ç«å¢™/å®‰å…¨ç»„
3. ä¸ºæ•æ„Ÿ API æ·»åŠ é¢å¤–è®¤è¯ï¼ˆJWTã€API Keyï¼‰
4. å®šæœŸè½®æ¢ client_id

### Q: æ”¯æŒ WebSocket å—ï¼Ÿ

A: âœ… æ”¯æŒï¼public-port å¯ä»¥å‡çº§åˆ° WebSocketï¼Œå®ç°ä¼šè¯æµå¼è¾“å‡ºã€‚

### Q: å’Œ frpã€ngrok æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

A:
- **frp/ngrok**ï¼šé€šç”¨ç«¯å£è½¬å‘å·¥å…·
- **ARP**ï¼šä¸“ä¸º AI æ™ºèƒ½ä½“ä¼˜åŒ–ï¼Œå†…ç½®ä¼šè¯ç®¡ç†ã€Claude é›†æˆã€è¿æ¥æ± ç­‰

### Q: å®¢æˆ·ç«¯æ—¥å¿—åœ¨å“ªé‡Œï¼Ÿ

A: æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ï¼š

| æ“ä½œç³»ç»Ÿ    | æ—¥å¿—ç›®å½•è·¯å¾„                                   |
|---------|------------------------------------------|
| Windows | C:\Users\<ç”¨æˆ·å>\AppData\Local\arpc\logs\  |
| Linux   | ~/.local/share/arpc/logs/                |
| macOS   | ~/Library/Application Support/arpc/logs/ |

æ—¥å¿—æ–‡ä»¶åæ ¼å¼ä¸º arpc.log.YYYY-MM-DDï¼Œæ¯å¤©è‡ªåŠ¨æ»šåŠ¨åˆ›å»ºæ–°æ–‡ä»¶ã€‚

å¦‚æœæ— æ³•è®¿é—®ç³»ç»Ÿç›®å½•ï¼Œä¼šå›é€€åˆ°å½“å‰å·¥ä½œç›®å½•ä¸‹çš„ ./arpc/logs/ã€‚


---

## ğŸ›£ï¸ è·¯çº¿å›¾

- [ ] Web ç®¡ç†é¢æ¿ï¼ˆæŸ¥çœ‹åœ¨çº¿å®¢æˆ·ç«¯ã€æµé‡ç»Ÿè®¡ï¼‰
- [ ] å†…ç½®è®¤è¯ç³»ç»Ÿï¼ˆä¸ä¾èµ– Tokenï¼‰
- [ ] ç«¯åˆ°ç«¯åŠ å¯†ï¼ˆE2EEï¼‰
- [ ] Docker é•œåƒå’Œ Kubernetes Helm Chart
- [ ] å®¢æˆ·ç«¯è‡ªåŠ¨æ›´æ–°æœºåˆ¶

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

è´¡çŒ®å‰è¯·ï¼š
- è¿è¡Œ `cargo fmt --all` æ ¼å¼åŒ–
- è¿è¡Œ `cargo clippy` é€šè¿‡æ£€æŸ¥
- ä¸ºæ–°åŠŸèƒ½ç¼–å†™æµ‹è¯•

---

## ğŸ“„ è®¸å¯è¯

MIT License

---

<div align="center">

**ARP - è®©å†…ç½‘ AI æ™ºèƒ½ä½“ï¼Œéšæ—¶éšåœ°è§¦æ‰‹å¯åŠ** ğŸŒ

è®©è·ç¦»ä¸å†æ˜¯é—®é¢˜ | è®©ç½‘ç»œä¸å†æ˜¯éšœç¢ | è®© AI æ— å¤„ä¸åœ¨

</div>
